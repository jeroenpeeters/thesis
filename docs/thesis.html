<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="Content-Style-Type" content="text/css" />
        <meta name="generator" content="pandoc" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                        <title></title>
        <style type="text/css">code{white-space: pre;}</style>
                                                    <style>
            body {
                font-family: Georgia;
                max-width: 800px;
                margin: 0 auto;
                line-height: 30px;
                font-size: 18px;
                padding-left: 350px;
                padding-right: 50px;
                color: #111;
            }
            
            h1, h2, h3, h4, h5, h6 {
                font-family: Arial;
            }
            
            h1 {
                padding-top: 200px;
                line-height: 50px;
            }
            h2 {
                padding-top: 30px;
            }
            h3 {
                padding-top: 20px;
            }
            h4 {
                padding-top: 10px;
            }
            p {
                text-align: justify;
            }
            p a {
                word-wrap: break-word;
                white-space: pre;
            }
            code {
                word-wrap: break-word;
            }
            blockquote {
                border-left: 3px solid #eee;
                margin-left: 20px;
                padding-left: 20px;
            }
            
            ::selection {
                background-color: #E4E4E4;
            }
            
            table {
                width: 100%;
            }
            table caption {
                font-weight: bold;
            }
            table tr {
                padding: 0;
                margin: 0;
                background-color: #f0f0f0;
            }
            table tr.even {
                background-color: #fafafa;
            }
            table td {
                margin: 0;
                padding: 3px 5px;
            }
            
            p span.added {
                color: green;
                background-color: #FFF3C5;
            }
            p span.removed {
                color: red;
                background-color: #FFF3C5;
            }
            
            #title-page {
                padding: 80px 0;
            }
            
            #TOC {
                position: fixed;
                left: 0;
                top: 0;
                overflow-y: scroll;
                height: 100%;
                background: #fafafa;
                max-width: 300px;
                font-family: Arial;
                font-size: 15px;
                line-height: 30px;
            }
            ::-webkit-scrollbar {
                width: 8px;
            }
            ::-webkit-scrollbar-track {
                background-color: #ECECEC;
            }
            ::-webkit-scrollbar-thumb {
                background-color: #B0B0B0;
                border-radius: 8px;
            }
            #TOC > ul {
                padding-right: 10px;
            }
            #TOC ul {
                list-style: none;
                padding-left: 20px;
            }
            #TOC ul li a {
                text-decoration: none;
                color: #364149;
                text-overflow: ellipsis;
                display: block;
                white-space: nowrap;
                overflow: hidden;
            }
            #TOC ul li a:hover {
                color: #008cff;
            }
            
            .figure {
                text-align: center;
            }
            .figure p {
                text-align: center;
                font-style: italic;
            }
            .figure img {
                  max-width: 100%;
            }
            </style>
                <script src="js/jquery.js"></script>
        <script src="js/diff.js"></script>
        <script src="js/main.js"></script>
    </head>
    <body>
                <!--
                -->
        <div id="title-page">
            <h1>Continuous Delivery</h1>
            <h2>Jeroen Peeters</h2>
        </div>
                    <div id="TOC">
                <ul>
                <li><a href="#abstract">Abstract</a></li>
                <li><a href="#acknowledgements">Acknowledgements</a></li>
                <li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
                <li><a href="#literature-review"><span class="toc-section-number">2</span> Literature review</a><ul>
                <li><a href="#introduction-1"><span class="toc-section-number">2.1</span> Introduction</a></li>
                <li><a href="#tools"><span class="toc-section-number">2.2</span> Tools</a></li>
                <li><a href="#process"><span class="toc-section-number">2.3</span> Process</a></li>
                <li><a href="#people"><span class="toc-section-number">2.4</span> People</a></li>
                <li><a href="#methodoloy"><span class="toc-section-number">2.5</span> Methodoloy</a></li>
                </ul></li>
                <li><a href="#the-development-organization"><span class="toc-section-number">3</span> The development organization</a></li>
                <li><a href="#what-is-continuous-delivery"><span class="toc-section-number">4</span> What is Continuous Delivery</a><ul>
                <li><a href="#continuous-integration"><span class="toc-section-number">4.1</span> Continuous Integration</a><ul>
                <li><a href="#revision-control-system"><span class="toc-section-number">4.1.1</span> Revision Control System</a></li>
                <li><a href="#continuous-integration-server"><span class="toc-section-number">4.1.2</span> Continuous Integration Server</a></li>
                </ul></li>
                <li><a href="#continuous-delivery"><span class="toc-section-number">4.2</span> Continuous Delivery</a></li>
                </ul></li>
                <li><a href="#continuous-delivery-at-the-development-organization"><span class="toc-section-number">5</span> Continuous Delivery at the Development Organization</a><ul>
                <li><a href="#scenarios"><span class="toc-section-number">5.1</span> Scenario's</a><ul>
                <li><a href="#scenario-1-a-new-project"><span class="toc-section-number">5.1.1</span> Scenario 1: A new project</a></li>
                <li><a href="#scenario-use-a-new-version-of-java"><span class="toc-section-number">5.1.2</span> Scenario: Use a new version of Java</a></li>
                <li><a href="#scenario-upgrade-the-application-server"><span class="toc-section-number">5.1.3</span> Scenario: Upgrade the application server</a></li>
                <li><a href="#scenario-application-instance-per-tester"><span class="toc-section-number">5.1.4</span> Scenario: Application instance per tester</a></li>
                <li><a href="#scenario-parallel-frontend-test-execution"><span class="toc-section-number">5.1.5</span> Scenario: Parallel frontend test execution</a></li>
                <li><a href="#scenario-install-a-plugin-in-jenkins-ci"><span class="toc-section-number">5.1.6</span> Scenario: Install a plugin in Jenkins CI</a></li>
                <li><a href="#scenario-upgrade-jenkins-ci"><span class="toc-section-number">5.1.7</span> Scenario: Upgrade Jenkins CI</a></li>
                <li><a href="#scenario-switch-to-another-tool"><span class="toc-section-number">5.1.8</span> Scenario: Switch to another tool</a></li>
                </ul></li>
                <li><a href="#ci-in-a-shared-environment"><span class="toc-section-number">5.2</span> CI in a shared environment</a><ul>
                <li><a href="#the-situation"><span class="toc-section-number">5.2.1</span> The situation</a></li>
                <li><a href="#scenarios-detailed"><span class="toc-section-number">5.2.2</span> Scenario's detailed</a></li>
                </ul></li>
                <li><a href="#ci-in-a-distributed-environment"><span class="toc-section-number">5.3</span> CI in a distributed environment</a><ul>
                <li><a href="#the-situation-1"><span class="toc-section-number">5.3.1</span> The situation</a></li>
                <li><a href="#scenarios-detailed-1"><span class="toc-section-number">5.3.2</span> Scenario's detailed</a></li>
                </ul></li>
                <li><a href="#a-new-project"><span class="toc-section-number">5.4</span> A new project</a><ul>
                <li><a href="#infrastructure-setup"><span class="toc-section-number">5.4.1</span> Infrastructure setup</a></li>
                <li><a href="#project-setup"><span class="toc-section-number">5.4.2</span> Project setup</a></li>
                <li><a href="#recurring-tasks"><span class="toc-section-number">5.4.3</span> Recurring tasks</a></li>
                </ul></li>
                <li><a href="#configuring-the-cd-pipeline"><span class="toc-section-number">5.5</span> Configuring the CD-pipeline</a><ul>
                <li><a href="#docker-dashboard"><span class="toc-section-number">5.5.1</span> Docker Dashboard</a></li>
                <li><a href="#configuration"><span class="toc-section-number">5.5.2</span> Configuration</a></li>
                <li><a href="#nexus-1"><span class="toc-section-number">5.5.3</span> Nexus</a></li>
                <li><a href="#gitlab-1"><span class="toc-section-number">5.5.4</span> Gitlab</a></li>
                <li><a href="#docker-registry"><span class="toc-section-number">5.5.5</span> Docker Registry</a></li>
                <li><a href="#sonar"><span class="toc-section-number">5.5.6</span> Sonar</a></li>
                <li><a href="#reporting"><span class="toc-section-number">5.5.7</span> Reporting</a></li>
                <li><a href="#selenium"><span class="toc-section-number">5.5.8</span> Selenium</a></li>
                <li><a href="#quality-dashboard"><span class="toc-section-number">5.5.9</span> Quality-dashboard</a></li>
                <li><a href="#jenkins"><span class="toc-section-number">5.5.10</span> Jenkins</a></li>
                <li><a href="#application-under-development"><span class="toc-section-number">5.5.11</span> Application under development</a></li>
                </ul></li>
                </ul></li>
                <li><a href="#stages-of-continuous-delivery"><span class="toc-section-number">6</span> Stages of Continuous Delivery</a><ul>
                <li><a href="#stage-1-ci-in-a-shared-environment"><span class="toc-section-number">6.1</span> Stage 1: CI in a shared environment</a></li>
                <li><a href="#stage-2-automated-cd-in-a-distributed-environment"><span class="toc-section-number">6.2</span> Stage 2: Automated CD in a distributed environment</a></li>
                <li><a href="#stage-3-----next-evolution.."><span class="toc-section-number">6.3</span> Stage 3: --- next evolution..</a></li>
                <li><a href="#initial-situation"><span class="toc-section-number">6.4</span> Initial situation</a></li>
                </ul></li>
                <li><a href="#references">References</a></li>
                </ul>
            </div>
                                <!--
This is the Latex-heavy title page.
People outside UCL may want to remove the header logo
and add the centred logo
-->

<!-- This page is for an official declaration. -->

<p>  </p>
<h1 id="abstract" class="unnumbered">Abstract</h1>
<p>tbd.</p>
<p> </p>
<h1 id="acknowledgements" class="unnumbered">Acknowledgements</h1>
<p>tbd</p>
<!-- Use the \newpage command to force a new page -->

<p></p>
<p></p>

<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<p>tbd.</p>
<h1 id="literature-review"><span class="header-section-number">2</span> Literature review</h1>
<!--
After the introductory chapter, it seems fairly common to
include a chapter that reviews the literature and
introduces methodology used throughout the thesis.
-->
<h2 id="introduction-1"><span class="header-section-number">2.1</span> Introduction</h2>
<p>tbd.</p>
<h2 id="tools"><span class="header-section-number">2.2</span> Tools</h2>
<h2 id="process"><span class="header-section-number">2.3</span> Process</h2>
<h2 id="people"><span class="header-section-number">2.4</span> People</h2>
<h2 id="methodoloy"><span class="header-section-number">2.5</span> Methodoloy</h2>
<h1 id="the-development-organization"><span class="header-section-number">3</span> The development organization</h1>
<p>In order to understand the problems at the organization it is important to have a deeper understanding of the development organization's structure. The organization is a semi-governmental IT project organization who's mission is to help other (semi-)governmental organizations with IT project management and the realization of projects. They lead by example and help the customer to shape their project according to agile principles. In this thesis we are only concerned with the department responsible for software project realization. Within the Software Delivery (SD) department project teams build software in an agile way. Because some customers are still used to work according to a waterfall approach the department plays an important role in guiding customers. The SD project team helps the customer getting familiar with Agile/Scrum principles in order for them to steer and make decisions about importance of tasks. Before a project ends up at SD it usually follows a pre-development process in which some architectural decisions are already made. This is mostly because governments have to apply to standards and regulations. Usually the software realization team is not involved in this process since the team is not yet in existence. This procedure as described here may vary per project and customer, but it usually applies. When the realization team is formed most of the fundamental decisions have already been taken.</p>
<p>To be able to quickly react to customer needs the development organization relies heavily on external hiring for the duration of a project. Within SD all project members are externals. This gives the organization the ability to quickly scale up or down depending on the number of active projects. However, it also implies that knowledge is easily lost. The organization tries to move people between projects as much as possible in order to retain them. In order to move people more easily between projects and bring new people up to speed more quickly the development phase is standardized within the department as much as possible. The standardization is targeted at process, tools and development frameworks and languages. This standardization is something that can change over time and is defined by SD itself. It is possible for a single project to differentiate from the standard following the &quot;comply or explain&quot;-principle.</p>
<p>The standardized process is based on Continuous Integration and Delivery (CI/CD) principles. In the next chapter we will take a closer look at the CI/CD process.</p>
<h1 id="what-is-continuous-delivery"><span class="header-section-number">4</span> What is Continuous Delivery</h1>
<p>In this chapter I will discuss what people generally understand by the term Continuous Delivery.</p>
<h2 id="continuous-integration"><span class="header-section-number">4.1</span> Continuous Integration</h2>
<p>Continuous Delivery is the natural evolution of Continuous Integration (CI). Practicing Continuous Integration is an absolute necessity before you can start with Continuous Delivery.</p>
<p>CI focuses on integrating different software branches into a main line. This generally occurs when developers make changes to the main line in their development environments.</p>
<p>To do CI one needs at least the following systems:</p>
<ol style="list-style-type: decimal">
<li>Revision Control System</li>
<li>Continuous Integration Server</li>
</ol>
<p>Figure  depicts the dependency relationship between the CI systems.</p>
<div class="figure">
<img src="figures/arch-overview-CI.png" alt="Overview Continuous Integration " />
<p class="caption">Overview Continuous Integration </p>
</div>
<h3 id="revision-control-system"><span class="header-section-number">4.1.1</span> Revision Control System</h3>
<p>The RCS covers the integration of code branches into a main line.</p>
<h3 id="continuous-integration-server"><span class="header-section-number">4.1.2</span> Continuous Integration Server</h3>
<p>A CI-server, sometimes referred to as the build server, automatically performs the build process when a code branch is integrated into the main line. This ensures that the software in the main line can still be build according to predefined rules. Furthermore it ensures that the change doesn't depend on development specific environments, reducing the 'it builds on my machine'-problem. Preferably the CI-server also executes tests to ensure that previous functionality is still intact.</p>
<h2 id="continuous-delivery"><span class="header-section-number">4.2</span> Continuous Delivery</h2>
<p>Since Continuous Delivery (CD) builds on top of CI it reuses its systems.</p>
<h1 id="continuous-delivery-at-the-development-organization"><span class="header-section-number">5</span> Continuous Delivery at the Development Organization</h1>
<p>In this chapter I describe the technical setup and infrastructure of the CI/CD environment at the development organization. First I describe the previous situation and then the current situation. I do this by describing a set of common scenario's.</p>
<h2 id="scenarios"><span class="header-section-number">5.1</span> Scenario's</h2>
<h3 id="scenario-1-a-new-project"><span class="header-section-number">5.1.1</span> Scenario 1: A new project</h3>
<p>When a new project is taken on by the development organization a technical infrastructure needs to be setup in order to accomodate the development process. It includes the setup of a ci/cd-pipeline, access-management and creation of serveral (virtual) deployment servers.</p>
<h3 id="scenario-use-a-new-version-of-java"><span class="header-section-number">5.1.2</span> Scenario: Use a new version of Java</h3>
<p>...</p>
<h3 id="scenario-upgrade-the-application-server"><span class="header-section-number">5.1.3</span> Scenario: Upgrade the application server</h3>
<p>...</p>
<h3 id="scenario-application-instance-per-tester"><span class="header-section-number">5.1.4</span> Scenario: Application instance per tester</h3>
<p>...</p>
<h3 id="scenario-parallel-frontend-test-execution"><span class="header-section-number">5.1.5</span> Scenario: Parallel frontend test execution</h3>
<p>...</p>
<h3 id="scenario-install-a-plugin-in-jenkins-ci"><span class="header-section-number">5.1.6</span> Scenario: Install a plugin in Jenkins CI</h3>
<p>...</p>
<h3 id="scenario-upgrade-jenkins-ci"><span class="header-section-number">5.1.7</span> Scenario: Upgrade Jenkins CI</h3>
<p>...</p>
<h3 id="scenario-switch-to-another-tool"><span class="header-section-number">5.1.8</span> Scenario: Switch to another tool</h3>
<p>...</p>
<h2 id="ci-in-a-shared-environment"><span class="header-section-number">5.2</span> CI in a shared environment</h2>
<p>This paragraph describes the previous CI/CD landscape at the development organization.</p>
<h3 id="the-situation"><span class="header-section-number">5.2.1</span> The situation</h3>
<p>The systems needed for CI/CD are managed by an Ops team. All projects use a set of shared services. Figure  depicts the relationship between the Ops team and the development teams. The shared services are:</p>
<ul>
<li>Subversion</li>
<li>Jenkins CI</li>
<li>Jenkins build servers</li>
<li>SonarQube</li>
<li>Nexus</li>
<li>Jira</li>
</ul>
<div class="figure">
<img src="figures/teams-in-shared-environment2.png" alt="Relationship between Ops and Development teams in a shared environment " />
<p class="caption">Relationship between Ops and Development teams in a shared environment </p>
</div>
<p>Besides the shared services each project would be assigned one or more deployment servers. The deployment servers are managed by the Ops team.</p>
<p>The next chapter describes common scenario's that occur in a CI/CD environment on request of the development team. These scenario's describe the impact on the development team.</p>
<h3 id="scenarios-detailed"><span class="header-section-number">5.2.2</span> Scenario's detailed</h3>
<p><strong>TODO</strong> In this paragraph I will detail the aforementioned scenario's for this type of environment. Which scenario's can be implemented in this environment? Are more troublesome? Cannot be implemented? Require a lot of manual intervention/work/configuration?</p>
<h2 id="ci-in-a-distributed-environment"><span class="header-section-number">5.3</span> CI in a distributed environment</h2>
<p>This paragraph describes the current CI/CD landscape at the development organization.</p>
<h3 id="the-situation-1"><span class="header-section-number">5.3.1</span> The situation</h3>
<p>Instead of managing the systems needed for CI/CD the Ops team manages a distributed environment in which teams are able to deploy applications at will and on demand.</p>
<div class="figure">
<img src="figures/teams-in-distributed-environment.png" alt="Relationship between Ops and Development teams in a distributed environment " />
<p class="caption">Relationship between Ops and Development teams in a distributed environment </p>
</div>
<h3 id="scenarios-detailed-1"><span class="header-section-number">5.3.2</span> Scenario's detailed</h3>
<p><strong>TODO</strong> In this paragraph I will detail the aforementioned scenario's for this type of environment. Which scenario's can be implemented in this environment? Are more troublesome? Cannot be implemented? Require a lot of manual intervention/work/configuration?</p>
<h2 id="a-new-project"><span class="header-section-number">5.4</span> A new project</h2>
<p>This paragraph conceptually describes what happens when a new project is embedded within the development organization. Besides organizational arrangements a technical infrastructure is setup to accommodate the development of the software application.</p>
<p>The following systems are employed:</p>
<ul>
<li>Gitlab</li>
<li>Jenkins CI</li>
<li>Jenkins build servers</li>
<li>SonarQube</li>
<li>Nexus</li>
<li>Mediawiki</li>
<li>Deployment servers</li>
<li>Jira</li>
<li>Releasemanager</li>
<li>Quality dashboard</li>
<li>Test reporting</li>
</ul>
<p>The next paragraphs talk about the tasks that happen initially and tasks that recur more frequently.</p>
<h3 id="infrastructure-setup"><span class="header-section-number">5.4.1</span> Infrastructure setup</h3>
<p>Initially every system used needs to be installed onto a target server. Depending on how you choose to do the installation, this might take some time.</p>
<h4 id="gitlab"><span class="header-section-number">5.4.1.1</span> Gitlab</h4>
<p>Gitlab is used as a revision control server.</p>
<ol style="list-style-type: decimal">
<li>Install Gitlab</li>
<li>Configure authentication mechanism (LDAP)</li>
<li>Set roles and permissions for users</li>
</ol>
<h4 id="jenkins-and-build-servers"><span class="header-section-number">5.4.1.2</span> Jenkins and build servers</h4>
<p>Depending on the project one or more build servers are needed. A build server has specific tooling on-board to be able to build the application. The following list details the installation steps.</p>
<ol style="list-style-type: decimal">
<li>Install Jenkins CI</li>
<li>Install one or more Jenkins build servers</li>
<li>Install specific tooling on the build server</li>
<li>Configure the build server in the main Jenkins server</li>
<li>Configure authentication mechanism (LDAP)</li>
</ol>
<h4 id="sonarqube"><span class="header-section-number">5.4.1.3</span> SonarQube</h4>
<p>SonarQube is used to continuously monitor the quality of the source code.</p>
<ol style="list-style-type: decimal">
<li>Install SonarQube</li>
<li>Configure authentication mechanism (LDAP)</li>
</ol>
<h4 id="nexus"><span class="header-section-number">5.4.1.4</span> Nexus</h4>
<p>Nexus is used to archive and distribute software artifacts.</p>
<ol style="list-style-type: decimal">
<li>Install Nexus</li>
<li>Configure authentication mechanism (LDAP)</li>
</ol>
<h4 id="mediawiki"><span class="header-section-number">5.4.1.5</span> Mediawiki</h4>
<p>Mediawiki is used as a team collaboration tool.</p>
<ol style="list-style-type: decimal">
<li>Install Mediawiki</li>
<li>Configure authentication mechanism (LDAP)</li>
</ol>
<h4 id="deployment-servers"><span class="header-section-number">5.4.1.6</span> Deployment servers</h4>
<p>For the purpose of deploying the application in a production like environment a deployment landscape has to be setup. Depending on the application this can be as simple as a single server, or as complex as a clustered setup of a Java application server with a corresponding complex database setup.</p>
<h4 id="jira"><span class="header-section-number">5.4.1.7</span> Jira</h4>
<p>Jira is readily available within the organization and doesn't need to be setup. However, it needs to be configured to accommodate the new project.</p>
<h3 id="project-setup"><span class="header-section-number">5.4.2</span> Project setup</h3>
<p>After the infrastructure is setup the project team adds configuration to the tools to be able to build and deploy their application.</p>
<ol style="list-style-type: decimal">
<li>A user for Jenkins needs to be created in Gitlab and configured in Jenkins so that Jenkins can checkout copies of the source code.</li>
<li>Code repositories are created in Gitlab for the corresponding applications.</li>
<li>Optional, import existing source code into Gitlab.</li>
<li>Configure jobs in Jenkins to build, test and deploy (for every application)</li>
<li>Configure the location of the SonarQube API in Jenkins</li>
<li></li>
</ol>
<h3 id="recurring-tasks"><span class="header-section-number">5.4.3</span> Recurring tasks</h3>
<h2 id="configuring-the-cd-pipeline"><span class="header-section-number">5.5</span> Configuring the CD-pipeline</h2>
<h3 id="docker-dashboard"><span class="header-section-number">5.5.1</span> Docker Dashboard</h3>
<p>Every project team is equipped with a Docker Dashboard. The dashboard is a web application through which the team can manage running applications on the Docker infrastructure. The dashboard exposes a user interface and a programmable interface for automation purposes. Through the dashboard the team manages:</p>
<ol style="list-style-type: decimal">
<li>Deployment of CD-pipeline support services</li>
<li>Deployment of the application under development</li>
</ol>
<p>Upon project start a vanilla dashboard is deployed. The team has the freedom to start any combination of Docker containers.</p>
<h3 id="configuration"><span class="header-section-number">5.5.2</span> Configuration</h3>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">jira-reporter-user</td>
<td align="left">reporter</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">jira-reporter-password</td>
<td align="left">****</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<h3 id="nexus-1"><span class="header-section-number">5.5.3</span> Nexus</h3>
<h4 id="add-nexus-to-docker-dashboard."><span class="header-section-number">5.5.3.1</span> Add nexus to Docker dashboard.</h4>
<p>Go to the Docker Dashboard user interface, click 'Apps', 'New App'. Enter the following app definition:</p>
<pre><code>name: nexus
version: 2.13.0-01
description: Sonatype Nexus repository manager.

#login with admin / admin123

#tags:infra

www:
 image: sonatype/nexus:2.13.0-01
 user: root
 volumes:
 - /sonatype-work</code></pre>
<p>Click 'Save changes' and start the application.</p>
<h4 id="configure-security"><span class="header-section-number">5.5.3.2</span> Configure security</h4>
<p>Go to the Nexus user interface and log in with</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Username</th>
<th align="left">Password</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Account</td>
<td align="left">admin</td>
<td align="left">admin123</td>
</tr>
</tbody>
</table>
<p>Go to 'Security', 'Users'. Select user <strong><em>anonymous</em></strong>. Give the user full control over all repositories. Click Add, select Repo: 'All Repositories (Full Control)'. Click 'OK' and 'Save'.</p>
<h3 id="gitlab-1"><span class="header-section-number">5.5.4</span> Gitlab</h3>
<h4 id="add-gitlab-to-docker-dashboard"><span class="header-section-number">5.5.4.1</span> Add Gitlab to Docker dashboard</h4>
<p>Go to the Docker Dashboard user interface, click 'Apps', 'New App'. Enter the following app definition:</p>
<pre><code>name: gitlab
version: 8.6.1

#tags:infra

www:
  image: www.docker-registry.isd.tld:5000/gitlab-ce:8.6.1
  volumes:
    - /etc/gitlab
    - /var/log/gitlab
    - /var/opt/gitlab</code></pre>
<p>Click 'Save changes' and start the application.</p>
<h4 id="create-root-account"><span class="header-section-number">5.5.4.2</span> Create root account</h4>
<p>Go to the Gitlab user interface. You will be asked to enter a new password for the root user. Enter the password twice and click 'Change your password'.</p>
<h4 id="create-usergroup-and-users"><span class="header-section-number">5.5.4.3</span> Create usergroup and user(s)</h4>
<p>Go to the Gitlab user interface. Log in with:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Username</th>
<th align="left">Password</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Account</td>
<td align="left">root</td>
<td align="left"><strong><em>see previous step</em></strong></td>
</tr>
</tbody>
</table>
<p>Go to 'Admin Area', 'Groups', 'New Group'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Group path</th>
<th align="left">Visibility Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">test-group</td>
<td align="left">Private</td>
</tr>
</tbody>
</table>
<p>Click 'Create Group'.</p>
<p>Go to 'Admin Area', 'Users', 'New User'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Username</th>
<th align="left">Email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><name></td>
<td align="left"><username></td>
<td align="left"><email></td>
</tr>
</tbody>
</table>
<p>Click 'Create user'.</p>
<p>Click 'Edit' and enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Password</th>
<th align="left">Password confirmation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">user@123!</td>
<td align="left">user@123!</td>
</tr>
</tbody>
</table>
<p>Click 'Save Changes'.</p>
<p>Go to 'Admin Area' &gt; 'Groups' &gt; 'test-group' Add user <username> to group with role 'Developer'.</p>
<p>Repeat for each user in the development team.</p>
<h4 id="create-jenkins-user"><span class="header-section-number">5.5.4.4</span> Create Jenkins user</h4>
<p>Jenkins should be able to login to Gitlab in order to be able to checkout copies of the source code. Therefore a dedicated user should be created.</p>
<p>Go to the Gitlab user interface. Log in with:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Username</th>
<th align="left">Password</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Account</td>
<td align="left">root</td>
<td align="left"><strong><em>see previous step</em></strong></td>
</tr>
</tbody>
</table>
<p>Go to 'Admin Area', 'Users', 'New User'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Username</th>
<th align="left">Email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Jenkins</td>
<td align="left">jenkins</td>
<td align="left">noreply@jenkins.tld</td>
</tr>
</tbody>
</table>
<p>Click 'Create User'.</p>
<p>Click 'Edit' and enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Password</th>
<th align="left">Password confirmation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">jenkins@123!</td>
<td align="left">jenkins@123!</td>
</tr>
</tbody>
</table>
<p>Click 'Save Changes'.</p>
<p>Go to 'Admin Area' &gt; 'Groups' &gt; 'test-group' Add user jenkins to group with role 'Master'.</p>
<h4 id="import-jenkins-ssh-public-key"><span class="header-section-number">5.5.4.5</span> Import Jenkins SSH public key</h4>
<p>Go to the Gitlab user interface. Log in with:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Username</th>
<th align="left">Password</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Account</td>
<td align="left">jenkins</td>
<td align="left">jenkins@123!</td>
</tr>
</tbody>
</table>
<p>Go to 'Profile Settings', 'SSH Keys'. Enter the SSH public key:</p>
<pre><code>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCrSFSIYRJjTbWqYuU6cGQ0aNae
wMQ/m0k3m/MA7mNb2LEGNb0CQAoJDwwuPiftfj9cP6UrTlFqKGRKuLlAD7qrf9kQ
OSzgfwDJ7lSYY8QqMP4U1CuL5IuMV/Zwg0npA9SnPpD8KcrxMQgKZ62F12xoR+vX
LMSgMnTwu7olZVQphdMcvu2H5ugV4kBNyyRfKSeDDatsYKnwVirhLBRMtdFTLqo2
wFe8dMM/2mZIiGl5KXg0gCXpD2VEFiVCINARGLsdh9nzn2gxLoagIbXzxWjGRo0t
u69GuS2YqNj7GX5QJMpTP4UAWPvymx1TiJqmWAatejdfhYeJWoTLA6dnxaFV</code></pre>
<p>Click 'Add key'.</p>
<h4 id="create-project-repository"><span class="header-section-number">5.5.4.6</span> Create project repository</h4>
<p>Go to the Gitlab user interface. Log in with:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Username</th>
<th align="left">Password</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Account</td>
<td align="left">root</td>
<td align="left"><strong><em>see previous step</em></strong></td>
</tr>
</tbody>
</table>
<p>Go to 'Admin Area' &gt; 'Projects' &gt; 'New Project'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Project Path</th>
<th align="left">Visibility</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">/test-group/test-project</td>
<td align="left">Private</td>
</tr>
</tbody>
</table>
<p>Click 'Create project'.</p>
<p>Go to 'Admin Area' &gt; 'Projects' &gt; 'test-group/test-project' &gt; 'Edit' &gt; 'Protected Branches' In table: 'Already Protected', Select Developers can push for branch master.</p>
<h3 id="docker-registry"><span class="header-section-number">5.5.5</span> Docker Registry</h3>
<h4 id="add-docker-registry-to-docker-dashboard"><span class="header-section-number">5.5.5.1</span> Add docker-registry to Docker dashboard</h4>
<p>Go to the Docker Dashboard user interface, click 'Apps', 'New App'. Enter the following app definition:</p>
<pre><code>name: docker-registry
version: 2.1.1

#tags:infra

www:
 image: distribution/registry:2.1.1
 mem_limit: 2048m
 environment:
  - REGISTRY_VERSION=0.1
  - REGISTRY_LOG_FIELDS_SERVICE=registry
  - REGISTRY_LOG_FIELDS_ENVIRONMENT=production
  - REGISTRY_STORAGE_CACHE_BLOBDESCRIPTOR=inmemory
  - REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY=/docker-registry/
  - &#39;REGISTRY_HTTP_ADDR=:5000&#39;
  - REGISTRY_HTTP_HEADERS_X-CONTENT-TYPE-OPTIONS=[nosniff]
  - REGISTRY_HEALTH_STORAGEDRIVER_ENABLED=true
  - REGISTRY_HEALTH_STORAGEDRIVER_INTERVAL=10s
  - REGISTRY_HEALTH_STORAGEDRIVER_THRESHOLD=3
 volumes:
  - /docker-registry</code></pre>
<p>Click 'Save changes' and start the application.</p>
<h3 id="sonar"><span class="header-section-number">5.5.6</span> Sonar</h3>
<h4 id="add-sonar-to-docker-dashboard"><span class="header-section-number">5.5.6.1</span> Add sonar to Docker dashboard</h4>
<p>Go to the Docker Dashboard user interface, click 'Apps', 'New App'. Enter the following app definition:</p>
<pre><code>name: sonar
version: 4.5.7
description: Manage code quality

#tags: infra
#login with admin/admin

www:
  image: sonarqube:4.5.7
  environment:
    - SONARQUBE_JDBC_USERNAME=sonar
    - SONARQUBE_JDBC_PASSWORD=sonar
    - &quot;SONARQUBE_JDBC_URL=jdbc:mysql://db/sonar?useUnicode=true&amp;amp;characterEncoding=utf8&quot;
  volumes:
    - /opt/sonarqube/extensions/downloads
    - /opt/sonarqube/extensions/plugins
  links:
    - db
  enable_ssh: true

db:
  image: mysql:5.6
  environment:
    - MYSQL_ROOT_PASSWORD=root
    - MYSQL_DATABASE=sonar
    - MYSQL_USER=sonar
    - MYSQL_PASSWORD=sonar
  volumes:
    - /var/lib/mysql</code></pre>
<p>Click 'Save changes' and start the application.</p>
<h4 id="install-plugins"><span class="header-section-number">5.5.6.2</span> Install plugins</h4>
<p>From a local shell execute:</p>
<pre><code>cd /path/to/dir/with/sonar/plugins
scp sonar-checkstyle-plugin-2.4.jar \
    sonar-findbugs-plugin-3.3.jar   \
    sonar-java-plugin-3.14.jar      \
    sonar-pmd-plugin-2.5.jar        \
    sonar-web-plugin-2.4.jar        \
    www.sonar.&lt;your-project&gt;.tld

ssh www.sonar.&lt;your-project&gt;.tld
cd /opt/sonarqube/extensions/plugins
rm * &amp;&amp; cp ~/* .
exit</code></pre>
<p>Go to the Docker Dashboard user interface and restart the Sonar application.</p>
<h4 id="add-quality-profiles"><span class="header-section-number">5.5.6.3</span> Add quality profiles</h4>
<p>Go to the Sonar user interface. Login with:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Username</th>
<th align="left">Password</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Account</td>
<td align="left">admin</td>
<td align="left">admin</td>
</tr>
</tbody>
</table>
<p>Go to 'Quality Profiles', Click 'Restore Profile'. Select 'Development Organization Java profile' to import and click 'Restore'. Click 'Restore Profile'. Select 'Development Organization Web profile' to import and click 'Restore'.</p>
<h3 id="reporting"><span class="header-section-number">5.5.7</span> Reporting</h3>
<h4 id="create-jira-filter"><span class="header-section-number">5.5.7.1</span> Create Jira filter</h4>
<p>Go to the Jira user interface. Login with:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Username</th>
<th align="left">Password</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Account</td>
<td align="left">jira-reporter-user</td>
<td align="left">jira-reporter-password</td>
</tr>
</tbody>
</table>
<p>Go to 'Issues', 'Search for issues'. If the basic search is shown instead of the advanced search, click Advanced. Enter the following query:</p>
<pre><code>project = &lt;Jira project name&gt; AND type in (Story, &quot;Logical Test Case&quot;, Systeemfunctie) ORDER BY type</code></pre>
<p>Click 'Save as'. Filter name: <name>. Click 'Submit'. Write down the filter-id of the filter (it’s displayed in the URL, https://jira.development-organization.nl/jira/issues/?filter=<filter-id>).</p>
<h4 id="add-reporting-application-to-docker-dashboard"><span class="header-section-number">5.5.7.2</span> Add reporting application to Docker Dashboard</h4>
<p>Go to the Docker Dashboard user interface, click 'Apps', 'New App'. Enter the following app definition:</p>
<pre><code>name: reporting
version: 2.2.2
description: Quality reporting

#tags: autorun

www:
  image: docker-registry.isd.tld:5000/birt-reports:2.1.65
  mem_limit: 2g
  environment:
    - REPORT_USER=reporter
    - REPORT_PASSWORD=reporter007
    - &#39;REPORT_URL=jdbc:postgresql://db:5432/birt&#39;
    - REPORT_USER_RM=reporter
    - REPORT_PASSWORD_RM=reporter007
    - &#39;REPORT_URL_RM=jdbc:postgresql://db:5432/birt&#39;
  links:
    - db

importer:
  image: docker-registry.isd.tld:5000/birt-jira-importer:2.4.1
  environment:
    - &#39;report_jdbc_url=jdbc:postgresql://db:5432/birt&#39;
    - &#39;jira_filter=filter=&lt;filter-id&gt;&#39;
  links:
    - db

trr:
  image: docker-registry.isd.tld:5000/birt-test-results-service:2.0.50
  environment:
    - &#39;report_jdbc_url=jdbc:postgresql://db:5432/birt&#39;
  links:
    - db

db:
    image: docker-registry.isd.tld:5000/birt-database:2.0.37
    volumes:
        - /var/lib/postgresql/data
    environment:
        - POSTGRES_PASSWORD=my-secret-pw
    mem_limit: 2g

rm:
  image: docker-registry.isd.tld:5000/releasemanager:1.0.36
  environment:
    - DB_DRIVER=pdo_pgsql
    - DB_HOST=db
    - DB_PORT=5432
    - DB_USER=releasemanager
    - DB_PASSWORD=releasemanager007
    - DB_DATABASE=birt
  volumes:
    - /mnt/publish
  links:
    - db</code></pre>
<p>Click 'Save changes' and start the application.</p>
<h3 id="selenium"><span class="header-section-number">5.5.8</span> Selenium</h3>
<h4 id="add-selenium-to-docker-dashboard"><span class="header-section-number">5.5.8.1</span> Add Selenium to Docker dashboard</h4>
<p>Go to the Docker Dashboard user interface, click 'Apps', 'New App'. Enter the following app definition:</p>
<pre><code>name: selenium
version: official

#tags: autorun

server:
  image: selenium/standalone-firefox</code></pre>
<p>Click 'Save changes' and start the application.</p>
<h3 id="quality-dashboard"><span class="header-section-number">5.5.9</span> Quality-dashboard</h3>
<p><strong>TODO! detail how to setup the quality tracking and monitoring system</strong> See http://wiki.isd.org/index.php/HandleidingKwaliteitssysteem &gt; Opzet van een kwaliteitsdashboard</p>
<h3 id="jenkins"><span class="header-section-number">5.5.10</span> Jenkins</h3>
<h4 id="add-jenkins-to-docker-dashboard"><span class="header-section-number">5.5.10.1</span> Add Jenkins to Docker dashboard</h4>
<p>Go to the Docker Dashboard user interface, click 'Apps', 'New App'. Enter the following app definition:</p>
<pre><code>name: jenkins
version: 1.651.2
description: An extendable open source CI server

#tags: autorun

www:
  image: jenkins:1.651.2
  volumes:
    - /var/jenkins_home
  environment:
    - &quot;JAVA_OPTS=-Duser.timezone=Europe/Amsterdam&quot;
  links:
    - jnlp
  enable_ssh: true

jnlp:
  image: tehranian/dind-jenkins-slave:latest
  environment:
    - &quot;DOCKER_DAEMON_ARGS=-H unix:///var/run/docker.sock -H tcp://0.0.0.0:2375 --insecure-registry 10.25.0.0/16&quot;
    - &quot;JAVA_OPTS=-Duser.timezone=Europe/Amsterdam&quot;
  mem_limit: 2g
  privileged: true
  enable_ssh: true</code></pre>
<p>Click 'Save changes' and start the application.</p>
<h4 id="install-plugins-1"><span class="header-section-number">5.5.10.2</span> Install plugins</h4>
<p>Go to the Jenkins user interface. Click 'Manage Jenkins', 'Manage Plugins', 'Available'. Tick the box next to the following plugins:</p>
<ul>
<li>Maven Release Plug-in Plug-in (0.14.0)</li>
<li>Git plugin (3.0.0)</li>
<li>SonarQube Plugin (2.4.4)</li>
<li>OWASP Dependency-Check Plugin (1.4.3)</li>
<li>Git client plugin (used by Git plugin)</li>
<li>SCM API Plugin (used by Git plugin)</li>
<li>Conditional BuildStep</li>
<li>Run Condition Plugin</li>
<li>Parameterized Trigger plugin</li>
<li>Workspace Cleanup Plugin</li>
<li>Build Pipeline Plugin</li>
</ul>
<h4 id="configure-system"><span class="header-section-number">5.5.10.3</span> Configure system</h4>
<p>Go to the Jenkins user interface. Click 'Manage Jenkins', 'Configure System'. Look for the section 'SonarQube servers'. Click 'Click Add SonarQube'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">SonarQube</td>
</tr>
<tr class="even">
<td align="left">Server URL</td>
<td align="left">http://www.sonar.<your-project>.tld:9000</td>
</tr>
<tr class="odd">
<td align="left">Server version</td>
<td align="left">5.1 or lower</td>
</tr>
<tr class="even">
<td align="left">Version of sonar-maven-plugin</td>
<td align="left">3.0.1</td>
</tr>
<tr class="odd">
<td align="left">Database URL</td>
<td align="left">jdbc:mysql://db.sonar.<your-project>.tld:3306/sonar</td>
</tr>
<tr class="even">
<td align="left">Database login</td>
<td align="left">sonar</td>
</tr>
<tr class="odd">
<td align="left">Database password</td>
<td align="left">sonar</td>
</tr>
</tbody>
</table>
<p>Look for the section 'Git plugin, Global config'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">user.name</td>
<td align="left">jenkins</td>
</tr>
<tr class="even">
<td align="left">user.email</td>
<td align="left">noreply@jenkins.tld</td>
</tr>
</tbody>
</table>
<p>Look for the section 'Maven'. Click 'Add Maven'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Maven 3.3.9</td>
</tr>
<tr class="even">
<td align="left">Version</td>
<td align="left">3.3.9</td>
</tr>
</tbody>
</table>
<p>Look for the section 'E-mail Notification'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SMT server</td>
<td align="left">smtp.isd.org</td>
</tr>
</tbody>
</table>
<p>Click 'Save'.</p>
<h4 id="add-gitlab-user"><span class="header-section-number">5.5.10.4</span> Add Gitlab user</h4>
<p>Go to the Jenkins user interface. Click 'Credentials', 'Global', 'Add credentials'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Kind</td>
<td align="left">SSH username with private key</td>
</tr>
<tr class="even">
<td align="left">Scope</td>
<td align="left">Global</td>
</tr>
<tr class="odd">
<td align="left">Username</td>
<td align="left">jenkins</td>
</tr>
<tr class="even">
<td align="left">Private key</td>
<td align="left">Enter directly</td>
</tr>
<tr class="odd">
<td align="left">Description</td>
<td align="left">Gitlab user</td>
</tr>
</tbody>
</table>
<p>Enter the key:</p>
<pre><code>-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAq0hUiGESY021qmLlOnBkNGjWnsDEP5tJN5vzAO5jW9ixBjW9
AkAKCQ8MLj4n7X4/XD+lK05RaihkSri5QA+6q3/ZEDks4H8Aye5UmGPEKjD+FNQr
i+SLjFf2cINJ6QPUpz6Q/CnK8TEICmethddsaEfr1yzEoDJ08Lu6JWVUKYXTHL7t
h+boFeJATcskXykngw2rbGCp8FYq4SwUTLXRUy6qNsBXvHTDP9pmSIhpeSl4NIAl
6Q9lRBYlQiDQERi7HYfZ859oMS6GoCG188VoxkaNLbuvRrktmKjY+xl+UCTKUz+F
AFj78psdU4iaplgGrXo3X4WHiVqEywOnZ8WhVQIDAQABAoIBAHSw9W5oe+eNpMut
TrBuq8YM+tLzT4BqIgqxw2+J+cU0Lv6lE9z5lhyv1MOYcwlZLn+BmNyVIeBqHlHN
4d+kF7AJjO+BlHJp9DaemaGsrpN0B1ZXakeHcA8wSmRC/dKzWmiKtqolKu8BUZIN
Kmn55xBwl1tkU500YvkzXFFn5FvYg7NzvdgajfrywgU6GIm6miGWzkb0F5MRnXtb
hhx32sSu9H87Fu54DpMIWQzzpqJuPPLL8SxZKheuceYcV/tXT6IG5WnSl3KnNVYX
cSLRN4miN6dVlX9GIdwsAxdrqexm/OLw/J5Mgf2SaIKslMNoGciojtaQaLt/ofde
UWa0lWECgYEA3kg9Tv8/iIWIzIYvgC8D/ZyjyExlcX6jVSrbFCjZyYhDqxA2LPSa
SQwcHesLk4c4GS1in47Mo/otxdPYnmu2o0Ob4hoICGLEJiWdiI7ljJ8CWtsjNGts
GhCsv3guTT1WnfOpWbsaKDodinEa2YNekxAjh/9EQZR4x6Y9EQ61C8kCgYEAxUOm
W8orY6M4YYeb1nA9izW1twjrK0jZ6u07n3ooAVJx5WNr69/ATZx/Lw4ou1RGZ3qb
q4/iol5DwenxcaETV5h5q/170pvnhkLoRIWd+Rd+oEu+GtYwVrLd/ybJZswJMYc/
KIRHrw3DpM0yVxrilENe3TQ8k2O3VJRsucmHly0CgYEA2Jq+m5dh2vB9MQhli1zF
X8LfWxUPGXzVPu4HFGsGZzvQ7QZcNIybOCmD0Ke13So8QVSXsXJe+j+VkRxyD1ZZ
YFlGsxq4zysnhyDKlULib5iXm9/FO5Sef/vVyrMbM4tdN4g0c8s+nwqatMio6GL6
qwZkCWd3pQxAchUNluylAfkCgYArkDIH6VDFs0D7QOBobecZfCYCIuUUbQU6/WMC
aA63pAZlGxy1PXeRbDMmKCFUpVra9Ve1fpQVOW4LP+fDKUhFOvX7xoH209lAbDwx
DbUCUm7zZWa5NH3+V4fxFha6LesF1hFbmELgZNDE70/jrptFFM+5WBTck9PjyNdt
/BSGjQKBgDS8bI/B6uMos882AG4eOcUBEVdaTaOIBqJEM0s5u8PPNBaXsx4kfH62
9vnfrX3tf8fj3UgrIsqEg/N2Pze2ktj8ikqz4cIJqX0fHHvEYC+FvqDcdit14Cv9
q0lAlP1AXSP4kry7SguwMTlewfcMUXxwTEIs0PXujqx8uTBLnUBY
-----END RSA PRIVATE KEY-----</code></pre>
<p>Click 'OK'.</p>
<h4 id="add-ssh-user-to-connect-to-dind-slave"><span class="header-section-number">5.5.10.5</span> Add SSH user to connect to dind-slave</h4>
<p>Go to the Jenkins user interface. Click 'Credentials', 'Global', 'Add credentials'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Kind</td>
<td align="left">SSH username with password</td>
</tr>
<tr class="even">
<td align="left">Scope</td>
<td align="left">Global</td>
</tr>
<tr class="odd">
<td align="left">Username</td>
<td align="left">jenkins</td>
</tr>
<tr class="even">
<td align="left">Password</td>
<td align="left">jenkins</td>
</tr>
<tr class="odd">
<td align="left">Description</td>
<td align="left">SSH user to connect to dind-node</td>
</tr>
</tbody>
</table>
<p>Click 'OK'</p>
<h4 id="add-dind-node"><span class="header-section-number">5.5.10.6</span> Add dind node</h4>
<p>Go to the Jenkins user interface. Click 'Manage Jenkins', 'Manage Nodes', 'New Node'. Enter:</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Node name</td>
<td align="left">docker-in-docker</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Dumb Slave</td>
</tr>
<tr class="odd">
<td align="left">Number of executors</td>
<td align="left">4</td>
</tr>
<tr class="even">
<td align="left">Remote root directory</td>
<td align="left">/tmp</td>
</tr>
<tr class="odd">
<td align="left">Labels</td>
<td align="left">docker</td>
</tr>
<tr class="even">
<td align="left">Usage</td>
<td align="left">Only build jobs with label restrictions matching this node</td>
</tr>
<tr class="odd">
<td align="left">Launch method</td>
<td align="left">Launch slave agents on Unix machines via SSH</td>
</tr>
<tr class="even">
<td align="left">Host</td>
<td align="left">jnlp.jenkins.<your-project>.tld</td>
</tr>
<tr class="odd">
<td align="left">Credentials</td>
<td align="left">jenkins (SSH user to connect to dind-node)</td>
</tr>
</tbody>
</table>
<p>Click 'Save'</p>
<h4 id="create-jenkins-job-for-sonar"><span class="header-section-number">5.5.10.7</span> Create Jenkins job for Sonar</h4>
<p>Go to the Jenkins user interface. Click 'New item'.</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Item name</td>
<td align="left">sonar-app</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Maven project</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<p><strong>Configure job sonar-app</strong></p>
<p>Go to the Jenkins user interface. Click 'sonar-app', 'Configure'.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Discard old builds</td>
<td align="left">Max # of builds to keep</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Git</td>
<td align="left">Repository URL</td>
<td align="left">git@www.gitlab.<your-project>.tld:test-group/test-project.git</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Credentials</td>
<td align="left">jenkins (gitlab user)</td>
</tr>
<tr class="even">
<td align="left">Build</td>
<td align="left">Root POM</td>
<td align="left">testapp/pom.xml</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Goals</td>
<td align="left">clean install -DskipTests</td>
</tr>
<tr class="even">
<td align="left">Post-build Actions</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">SonarQube analysis with Maven</td>
</tr>
</tbody>
</table>
<p>Click 'Save'.</p>
<h4 id="create-jenkins-job-for-owasp-dependency-checker"><span class="header-section-number">5.5.10.8</span> Create Jenkins job for OWASP dependency checker</h4>
<p>Go to the Jenkins user interface. Click 'New item'.</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Item name</td>
<td align="left">dependency-check-app</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Maven project</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<p><strong>Configure job dependency-check-app</strong></p>
<p>Go to the Jenkins user interface. Click 'dependency-check-app', 'Configure'.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Discard old builds</td>
<td align="left">Max # of builds to keep</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Git</td>
<td align="left">Repository URL</td>
<td align="left">git@www.gitlab.<your-project>.tld:test-group/test-project.git</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Credentials</td>
<td align="left">jenkins (gitlab user)</td>
</tr>
<tr class="even">
<td align="left">Build</td>
<td align="left">Root POM</td>
<td align="left">testapp/pom.xml</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Goals</td>
<td align="left">clean install -DskipTests</td>
</tr>
<tr class="even">
<td align="left">Post Steps</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Run regardless of build resultaat</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left">Invoke OWASP Dependency-Check analysis</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><strong><em>click</em></strong></td>
<td align="left">Advanced</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Generate optional HTML reports</td>
</tr>
<tr class="even">
<td align="left">Post-build Actions</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Publish OWASP Dependency-Check analysis results</td>
</tr>
</tbody>
</table>
<p>Click 'Save'.</p>
<h4 id="create-job-build-app"><span class="header-section-number">5.5.10.9</span> Create job build-app</h4>
<p>Go to the Jenkins user interface. Click 'New item'.</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Item name</td>
<td align="left">build-app</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Maven project</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<p><strong>Configure job build-app</strong> Go to the Jenkins user interface. Click 'build-app', 'Configure'.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Discard old builds</td>
<td align="left">Max # of builds to keep</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Git</td>
<td align="left">Repository URL</td>
<td align="left">git@www.gitlab.<your-project>.tld:test-group/test-project.git</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Credentials</td>
<td align="left">jenkins (gitlab user)</td>
</tr>
<tr class="even">
<td align="left">Additional Behaviours</td>
<td align="left"></td>
<td align="left">Check out to specific local branch</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Branch name</td>
<td align="left">master</td>
</tr>
<tr class="even">
<td align="left">Build Triggers</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Poll SCM</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Schedule</td>
<td align="left">H/5 * * * *</td>
</tr>
<tr class="even">
<td align="left">Build environment</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Installed maven version</td>
</tr>
<tr class="odd">
<td align="left">Build</td>
<td align="left">Root POM</td>
<td align="left">testapp/pom.xml</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Goals</td>
<td align="left">clean install</td>
</tr>
</tbody>
</table>
<p>Click 'Save'.</p>
<h4 id="create-job-build-image"><span class="header-section-number">5.5.10.10</span> Create job build-image</h4>
<p>Go to the Jenkins user interface. Click 'New item'.</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Item name</td>
<td align="left">build-image</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Freestyle project</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<p><strong>Configure job build-image</strong> Go to the Jenkins user interface. Click 'build-image', 'Configure'.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Discard old builds</td>
<td align="left">Max # of builds to keep</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Restrict</td>
<td align="left">Label Expression</td>
<td align="left">docker</td>
</tr>
<tr class="odd">
<td align="left">Git</td>
<td align="left">Repository URL</td>
<td align="left">git@www.gitlab.<your-project>.tld:test-group/test-project.git</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Credentials</td>
<td align="left">jenkins (gitlab user)</td>
</tr>
<tr class="odd">
<td align="left">Build</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Execute shell</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Command</td>
<td align="left">cd docker &amp;&amp; ./build.sh</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<h4 id="create-job-sonar-art"><span class="header-section-number">5.5.10.11</span> Create job sonar-art</h4>
<p>Go to the Jenkins user interface. Click 'New item'.</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Item name</td>
<td align="left">sonar-art</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Maven project</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<p><strong>Configure job sonar-art</strong> Go to the Jenkins user interface. Click 'sonar-art', 'Configure'.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Discard old builds</td>
<td align="left">Max # of builds to keep</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Git</td>
<td align="left">Repository URL</td>
<td align="left">git@www.gitlab.<your-project>.tld:test-group/test-project.git</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Credentials</td>
<td align="left">jenkins (gitlab user)</td>
</tr>
<tr class="even">
<td align="left">Build</td>
<td align="left">Root POM</td>
<td align="left">testART/pom.xml</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Goals</td>
<td align="left">clean install -DskipTests</td>
</tr>
<tr class="even">
<td align="left">Post-build Actions</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">SonarQube analysis with Maven</td>
</tr>
</tbody>
</table>
<p>Click 'Save'.</p>
<h4 id="create-job-build-art"><span class="header-section-number">5.5.10.12</span> Create job build-art</h4>
<p>Go to the Jenkins user interface. Click 'New item'.</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Item name</td>
<td align="left">build-art</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Maven project</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<p><strong>Configure job build-art</strong> Go to the Jenkins user interface. Click 'build-art', 'Configure'.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Discard old builds</td>
<td align="left">Max # of builds to keep</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Git</td>
<td align="left">Repository URL</td>
<td align="left">git@www.gitlab.<your-project>.tld:test-group/test-project.git</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Credentials</td>
<td align="left">jenkins (gitlab user)</td>
</tr>
<tr class="even">
<td align="left">Additional Behaviours</td>
<td align="left"></td>
<td align="left">Check out to specific local branch</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Branch name</td>
<td align="left">master</td>
</tr>
<tr class="even">
<td align="left">Build environment</td>
<td align="left">Release Ggoals</td>
<td align="left">-Dresume=false release:prepare release:perform -Darguments=&quot;-DskipTests&quot;</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">DryRun goals</td>
<td align="left">-Dresume=false -DdryRun=true release:prepare -Darguments=&quot;-DskipTests&quot;</td>
</tr>
<tr class="even">
<td align="left">Build</td>
<td align="left">Root POM</td>
<td align="left">testART/pom.xml</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Goals</td>
<td align="left">clean install -DskipTests</td>
</tr>
</tbody>
</table>
<p>Click 'Save'.</p>
<h4 id="create-job-run-art"><span class="header-section-number">5.5.10.13</span> Create job run-art</h4>
<p>Go to the Jenkins user interface. Click 'New item'.</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Item name</td>
<td align="left">run-art</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Maven project</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<p><strong>Configure job run-art</strong> Go to the Jenkins user interface. Click 'run-art', 'Configure'.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Discard old builds</td>
<td align="left">Max # of builds to keep</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Parameters</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">This build is parametrized</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Add String Parameter</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Name</td>
<td align="left">browserType</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Default Value</td>
<td align="left">FIREFOX</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Add String Parameter</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Name</td>
<td align="left">seleniumServerUrl</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Default Value</td>
<td align="left">http://server.selenium.<your-project>.tld:4444/wd/hub</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">Add String Parameter</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Name</td>
<td align="left">applicationServerUrl</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Default Value</td>
<td align="left">http://www.testapp.<your-project>.tld:8080</td>
</tr>
<tr class="even">
<td align="left">Git</td>
<td align="left">Repository URL</td>
<td align="left">git@www.gitlab.<your-project>.tld:test-group/test-project.git</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Credentials</td>
<td align="left">jenkins (gitlab user)</td>
</tr>
<tr class="even">
<td align="left">Build</td>
<td align="left">Root POM</td>
<td align="left">testART/pom.xml</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Goals</td>
<td align="left">-DbrowserType=<span class="math inline"><em>b</em><em>r</em><em>o</em><em>w</em><em>s</em><em>e</em><em>r</em><em>T</em><em>y</em><em>p</em><em>e</em> − <em>D</em><em>s</em><em>e</em><em>l</em><em>e</em><em>n</em><em>i</em><em>u</em><em>m</em><em>S</em><em>e</em><em>r</em><em>v</em><em>e</em><em>r</em><em>U</em><em>r</em><em>l</em>=</span>seleniumServerUrl -DapplicationServerUrl=$applicationServerUrl clean test</td>
</tr>
</tbody>
</table>
<p>Add 'Execute shell' Post Step. Select 'Run only if build succeeds'. Enter command:</p>
<pre><code>export \
  URL=&quot;http://trr.reporting.&lt;your-project&gt;.tld:4567/upload&quot; \
  APP_NAME=&quot;Testapp&quot; \
  APP_VERSION=&quot;SNAPSHOT&quot; \
  TEST_DESCRIPTION=&quot;ART Testapp&quot; \
  TEST_USER=&quot;Jenkins&quot; \
  TEST_VERSION=&quot;Master&quot; \
  TEST_TARGET=&quot;$applicationServerUrl&quot; \
  TEST_PLATFORM=&quot;$browserType&quot; \
  TEST_RUN=&quot;ART&quot; \
  DIR=&quot;testART/target/surefire-reports/junitreports&quot;

# Parallele upload van resultaat
echo &quot;Sending reports in ${DIR}&quot;
echo &quot;${APP_NAME}&quot;
for file in $DIR/\*.xml; do
  [ -f $file ] || continue
  echo $file
done | xargs -I{} --max-procs 0 bash -c &#39;
  curl ${URL} \
    -s \
    -F &quot;junit=@{}&quot; \
    -F &quot;application_name=${APP_NAME}&quot; \
    -F &quot;application_version=${APP_VERSION}&quot; \
    -F &quot;testrun_description=${TEST_DESCRIPTION}&quot; \
    -F &quot;testrun_user=${TEST_USER}&quot; \
    -F &quot;testrun_version=${TEST_VERSION}&quot; \
    -F &quot;test_target=${TEST_TARGET}&quot; \
    -F &quot;test_platform=${TEST_PLATFORM}&quot; \
    -F &quot;testrun=${TEST_RUN}&quot; \</code></pre>
<h4 id="create-job-load-ltcs"><span class="header-section-number">5.5.10.14</span> Create job load-ltcs</h4>
<p>Go to the Jenkins user interface. Click 'New item'.</p>
<table>
<thead>
<tr class="header">
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Item name</td>
<td align="left">load-ltcs</td>
</tr>
<tr class="even">
<td align="left">Type</td>
<td align="left">Freestyle project</td>
</tr>
</tbody>
</table>
<p>Click 'OK'.</p>
<p><strong>Configure job load-ltcs</strong> Go to the Jenkins user interface. Click 'load-ltcs', 'Configure'.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Property</th>
<th align="left">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Discard old builds</td>
<td align="left">Max # of builds to keep</td>
<td align="left">5</td>
</tr>
<tr class="even">
<td align="left">Bruild Trigers</td>
<td align="left"><strong><em>select</em></strong></td>
<td align="left">periodically</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Schedule</td>
<td align="left">H 6-20 * * 1-5</td>
</tr>
</tbody>
</table>
<p>Add 'Execute shell' Build Step. Enter command:</p>
<pre><code>#!/bin/bash -ex

# JIRA importer aanroepen
data=$(curl -s http://importer.reporting.&lt;your-project&gt;.tld:4567/import)

if [ &quot;$data&quot; == &#39;Import completed&#39; ]
then
  exit 0
else
  exit 1
fi</code></pre>
<h3 id="application-under-development"><span class="header-section-number">5.5.11</span> Application under development</h3>
<h4 id="add-application-to-docker-dashboard"><span class="header-section-number">5.5.11.1</span> Add application to Docker Dashboard</h4>
<p>Go to the Docker Dashboard user interface, click 'Apps', 'New App'. Enter the following app definition:</p>
<pre><code>name: testapp
version: latest

www:
  image: www.docker-registry.&lt;your-project&gt;.tld:5000/testapp:latest
  enable_ssh: true</code></pre>
<p>Click 'Save changes' and start the application.</p>
<!-- Wat is code
hoe organiseren we het nu
laat afhankelijkheden zien tussen applicaties
kan je laten zien hoeveel kennis er eigenlijk nodig is om dit voor mekaar te krijgen
waarom is het zo.

basic ci setup -> laat zien waar problemen zitten.

specificatie template meta. wat moeten we vastleggen.
van elk van de items een voorbeeld uitwerken. -->
<h1 id="stages-of-continuous-delivery"><span class="header-section-number">6</span> Stages of Continuous Delivery</h1>
<p>In this chapter I describe the different stages of continuous delivery that the development organization went through.</p>
<table>
<caption>Demonstration of simple table syntax.</caption>
<thead>
<tr class="header">
<th align="left">Right Le</th>
<th align="left">ft</th>
<th align="left">Center De</th>
<th align="left">fault</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">12 12</td>
<td align="left"></td>
<td align="left">12</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">123 12</td>
<td align="left">3</td>
<td align="left">123</td>
<td align="left">123</td>
</tr>
<tr class="odd">
<td align="left">1 1</td>
<td align="left"></td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
<h2 id="stage-1-ci-in-a-shared-environment"><span class="header-section-number">6.1</span> Stage 1: CI in a shared environment</h2>
<div class="figure">
<img src="figures/mermaid/basic-ci-schematic.mermaid.png" alt="CI/CD Schematic Overview " />
<p class="caption">CI/CD Schematic Overview </p>
</div>
<p><strong>Characteristics</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">.</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CI/CD Environment</td>
<td align="left">Shared</td>
</tr>
<tr class="even">
<td align="left">Maintenance</td>
<td align="left">System Administrator</td>
</tr>
<tr class="odd">
<td align="left">Deployment</td>
<td align="left">Manual</td>
</tr>
<tr class="even">
<td align="left">Flexibility</td>
<td align="left">Static</td>
</tr>
</tbody>
</table>
<!-- - Shared between teams
- Maintenance by system administrators
- Manual maintenance
- Static deployment servers -->
<p><strong>Systems</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Server</th>
<th align="left">Type</th>
<th align="left">Depends on</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Subversion</td>
<td align="left">Version Control</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Jenkins</td>
<td align="left">Build Server, CI</td>
<td align="left">Nexus, Sonar, Selenium</td>
</tr>
<tr class="odd">
<td align="left">Nexus</td>
<td align="left">Artifact Repository</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Sonar</td>
<td align="left">Static Code Analysis</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Selenium</td>
<td align="left"></td>
<td align="left">Deployment Server</td>
</tr>
<tr class="even">
<td align="left">Deployment Server</td>
<td align="left"></td>
<td align="left">Nexus</td>
</tr>
</tbody>
</table>
<!-- - Subversion
- Jenkins
- Nexus
- Sonar
- Selenium
- Deployment server -->
<p><strong>Tools</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Tool</th>
<th align="left">Type</th>
<th align="left">Used by</th>
<th align="left">Depends on</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Maven</td>
<td align="left">Build</td>
<td align="left">Dev, Jenkins</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Java</td>
<td align="left">Language, platform</td>
<td align="left">Dev, Jenkins</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Custom quality reporting</td>
<td align="left">Reporting</td>
<td align="left">Jenkins</td>
<td align="left">Sonar, Selenium</td>
</tr>
</tbody>
</table>
<!--
- Maven
- Java
- Custom quality reporting
- *this list is incomplete* -->
<p><strong>Setup</strong></p>
<ul>
<li>Setup is done by system administrators</li>
</ul>
<p><strong>Manual steps</strong></p>
<table>
<colgroup>
<col width="33%" />
<col width="37%" />
<col width="29%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Task</th>
<th align="left">Depends on</th>
<th align="left">Occurrence</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Create build job</td>
<td align="left">Jenkins</td>
<td align="left">every new unit of development</td>
</tr>
<tr class="even">
<td align="left">Create deployment job</td>
<td align="left">Jenkins</td>
<td align="left">every new unit of development</td>
</tr>
<tr class="odd">
<td align="left">Configure quality report</td>
<td align="left">Jenkins, Quality reporting</td>
<td align="left">every new unit of development</td>
</tr>
<tr class="even">
<td align="left">Maintain server configuration</td>
<td align="left">Deployment Server</td>
<td align="left">on configuration change</td>
</tr>
<tr class="odd">
<td align="left">Trigger deployment</td>
<td align="left">Deployment Server, Jenkins</td>
<td align="left">on request of tester or stakeholder</td>
</tr>
<tr class="even">
<td align="left">Trigger automated tests</td>
<td align="left">Deployment Server, Jenkins, Selenium</td>
<td align="left">every iteration</td>
</tr>
</tbody>
</table>
<!--
- Create build jobs, (once for every unit of development)
- Configure quality reports, (once for every unit of development)
- Manually maintain configuration of deployment server, (every time server configuration changes)
- Tester requests deployment of new version (direct communication)
- Trigger deployment job, (every time a tester requests a new version)
- Trigger automated tests
- *this list is incomplete* -->
<p><strong>Problems</strong></p>
<table>
<colgroup>
<col width="76%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Description</th>
<th align="left">Has negative impact on</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Resource sharing between all teams</td>
<td align="left">Scalability</td>
</tr>
<tr class="even">
<td align="left">Changes and upgrades affect all teams</td>
<td align="left">Stability</td>
</tr>
<tr class="odd">
<td align="left">Teams can't change setup or install plugins</td>
<td align="left">Flexibility, Usability</td>
</tr>
<tr class="even">
<td align="left">Teams can interfere with each other</td>
<td align="left">Stability</td>
</tr>
<tr class="odd">
<td align="left">Teams depend on sysadmins</td>
<td align="left">Agility</td>
</tr>
<tr class="even">
<td align="left">Deployment server changes are difficult to reverse</td>
<td align="left">Flexibility, Scalability</td>
</tr>
<tr class="odd">
<td align="left">Unable to deploy multiple instances of an application</td>
<td align="left">Agility, Usability</td>
</tr>
</tbody>
</table>
<!--

- Limited resources per team
- Doesn't scale beyond N teams
- Changes/upgrades affect all teams
- Teams can't install plugins or make changes to the setup
- Teams can interfere with each other causing difficult to debug and random failures
- Teams request changes to the infrastructure from the system administrators
 - Might take considerable amount of time
 - Request can be denied
- Changes to deployment server are not repeatable
- Difficult to go back N versions of the application and server configuration -->
<h2 id="stage-2-automated-cd-in-a-distributed-environment"><span class="header-section-number">6.2</span> Stage 2: Automated CD in a distributed environment</h2>
<p><strong>Characteristics</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">.</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CI/CD Environment</td>
<td align="left">Per team</td>
</tr>
<tr class="even">
<td align="left">Maintenance</td>
<td align="left">Team</td>
</tr>
<tr class="odd">
<td align="left">Deployment</td>
<td align="left">Automatic</td>
</tr>
<tr class="even">
<td align="left">Flexibility</td>
<td align="left">On-demand</td>
</tr>
</tbody>
</table>
<ul>
<li>Each team has his own CI/CD environment</li>
<li>The team is responsible for the environment (DevOps)</li>
<li>Dynamic deployment cluster</li>
<li>Application deployment is scripted</li>
<li>System administrators maintain the deployment cluster</li>
<li>Teams decide what their CI/CD landscape looks like</li>
</ul>
<p><strong>Systems</strong></p>
<ul>
<li>Gitlab</li>
<li>Jenkins</li>
<li>Nexus</li>
<li>Sonar</li>
<li>Selenium</li>
<li>Deployment server</li>
</ul>
<p><strong>Tools</strong></p>
<ul>
<li>Maven</li>
<li>Docker</li>
<li>Custom quality reporting</li>
</ul>
<p><strong>Manual steps</strong></p>
<ul>
<li>s1</li>
</ul>
<p><strong>Problems</strong></p>
<ul>
<li>p1</li>
</ul>
<h2 id="stage-3-----next-evolution.."><span class="header-section-number">6.3</span> Stage 3: --- next evolution..</h2>
<p>tbd..</p>
<h2 id="initial-situation"><span class="header-section-number">6.4</span> Initial situation</h2>
<p><strong>! This needs to be placed elsewhere and rewritten !</strong></p>
<p>Figure  shows the steps and interactions a developer has with build systems in order to deploy a change in the software to a target server.</p>
<div class="figure">
<img src="figures/mermaid/basic-ci-sequencediag.mermaid.png" alt="Basic CI " />
<p class="caption">Basic CI </p>
</div>
<p>Figure  shows the steps a developer needs to take in order to setup a single source repository and configure the continuous integration pipeline.</p>
<div class="figure">
<img src="figures/mermaid/basic-ci-initial-setup.mermaid.png" alt="Basic CI setup " />
<p class="caption">Basic CI setup </p>
</div>
<p></p>
<!-- 
Do not edit this page.

References are automatically generated from the BibTex file (References.bib)

...which you should create using your reference manager.
-->
<h1 id="references" class="unnumbered">References</h1>
<div id="refs" class="references">

</div>
            </body>
</html>
